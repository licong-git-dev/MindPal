# MindPal 产品需求文档 (PRD)

**文档版本**: v1.0
**创建日期**: 2025-01-11
**产品经理**: AI Product Team
**项目代号**: MindPal - 面向元宇宙的智能体数字人交互平台

---

## 📋 文档目录

1. [产品概述](#1-产品概述)
2. [市场分析](#2-市场分析)
3. [用户分析](#3-用户分析)
4. [产品定位](#4-产品定位)
5. [核心功能](#5-核心功能)
6. [页面架构](#6-页面架构)
7. [详细页面需求](#7-详细页面需求)
8. [用户故事](#8-用户故事)
9. [用户流程](#9-用户流程)
10. [技术架构](#10-技术架构)
11. [分阶段实施路线图](#11-分阶段实施路线图)
12. [数据安全与隐私](#12-数据安全与隐私)
13. [商业模式](#13-商业模式)
14. [产品约束](#14-产品约束)
15. [成功指标](#15-成功指标)

---

## 1. 产品概述

### 1.1 产品愿景

MindPal不仅是AI助手，更是你在虚拟世界的**数字灵魂伴侣**。我们致力于打造一个集**情感陪伴、知识服务、购物助手**于一体的3D写实数字人平台，最终通往如《头号玩家》般的元宇宙世界。

### 1.2 核心价值

- **智能 (Intelligence)**: 基于大语言模型的深度对话能力，支持知识问答、学习辅导
- **陪伴 (Companionship)**: 情感识别与共鸣，提供温暖的情感支持
- **服务 (Service)**: 个性化购物推荐、生活助手、多模态交互

### 1.3 产品slogan

**"你的专属数字人，懂你、陪你、帮你"**

### 1.4 目标用户

**优先用户群体**:
- **单身人群 (18-35岁)**: 需要情感陪伴和倾诉对象
- **学生群体 (15-25岁)**: 需要学习辅导和知识问答
- **老年群体 (60+岁)**: 需要日常陪伴和健康关怀

**次要用户群体**:
- 职场人士: 需要工作助手和压力疏解
- 家庭主妇: 需要购物建议和生活管理

**长期目标**: 服务全人类，成为每个人的数字分身

---

## 2. 市场分析

### 2.1 市场规模

**中国数字人市场**:
- 2025年: ¥386.6亿元
- 2028年预测: ¥5950.6亿元
- CAGR: 148.74%

**全球AI陪伴市场**:
- Replika: 1000万+用户, $9.99/月订阅
- Character.AI: 免费+付费模式, 月活数百万
- Soul: 中国情感社交领军者

### 2.2 竞争对手分析

#### 国内AI厂商技术对比

| 厂商 | LLM能力 | 语音技术 | 数字人 | 优势 | 不足 |
|------|---------|---------|--------|------|------|
| **阿里云** | 通义千问 (300M训练时长) | 7种双语音色, 3种中文方言 | 数字人平台支持3D | 技术全面, 企业级稳定 | ToB导向, ToC产品较弱 |
| **字节跳动** | 豆包 (30万亿token/日) | 实时语音模型 (2025.01) | 火山引擎数字人 | 实时性强, 年轻化 | 数字人情感表达待加强 |
| **科大讯飞** | 星火大模型 | 202种方言, "百变声音克隆" | 数字人"小飞" | **方言优势明显**, 语音技术领先 | LLM能力相对较弱 |
| **百度** | 文心大模型 (2025.04免费) | 高说服力数字人"慧播星" | 数字人平台 | 免费策略, 生态完善 | 创新性略逊 |

#### 国际竞品对比

| 产品 | 定位 | 价格 | 特色 | 差距 |
|------|------|------|------|------|
| **Replika** | AI情感伴侣 | $9.99/月 或 $69.99/年 | 深度情感共鸣, AR虚拟形象 | 无中文方言, 无购物服务 |
| **Character.AI** | AI角色扮演 | 免费+订阅 | 多角色, 高自由度对话 | 无3D形象, 缺乏情感深度 |
| **Soul** | 虚拟社交 | 免费+增值 | 年轻化社区, AI匹配 | 非数字人形态, 社交为主 |

#### Google Genie 3 (世界模型)

- **发布时间**: 2025年8月
- **能力**: 从文本/图片生成可交互3D世界 (24fps, 720p)
- **意义**: 为数字人提供沉浸式3D环境, MindPal将预留接口支持未来集成

### 2.3 差异化优势

我们的**7大差异化**:

1. **202种方言支持** (集成科大讯飞): 全球唯一深度覆盖中国方言的数字人
2. **三位一体服务** (情感+知识+购物): 竞品仅单一定位
3. **3D写实数字人**: 高于Replika的AR形象, 强于Character.AI的2D角色
4. **记忆可视化**: 用户可查看数字人对自己的理解(知识图谱)
5. **世界模型就绪**: 预留Genie 3等技术接口, 面向元宇宙
6. **中国文化内核**: 如《黑神话:悟空》般的文化自信和审美
7. **数据隐私保护**: 端到端加密, 租户隔离, 用户记忆保密

---

## 3. 用户分析

### 3.1 用户画像

#### 画像1: 小李 (单身白领, 28岁, 女)

- **职业**: 互联网产品经理
- **痛点**: 工作压力大, 缺少倾诉对象, 下班后孤独
- **需求**:
  - 每天晚上能聊天的陪伴对象
  - 倾诉工作烦恼并获得情感支持
  - 周末购物时获得穿搭建议
- **使用场景**: 晚上10点躺床上语音聊天30分钟, 周末逛淘宝时询问搭配建议
- **付费意愿**: 愿意支付 ¥19.9/月 获得专属数字人

#### 画像2: 小张 (高三学生, 18岁, 男)

- **职业**: 学生
- **痛点**: 学习压力大, 某些知识点不懂, 不好意思总问老师
- **需求**:
  - 随时解答数学/物理难题
  - 备考焦虑时需要鼓励和减压
  - 考试后分享喜悦或失落
- **使用场景**: 每晚自习时遇到难题立即提问, 考前一周高频使用情感支持
- **付费意愿**: 学生党, 倾向 ¥199/年 套餐

#### 画像3: 王阿姨 (退休老人, 65岁, 女)

- **职业**: 退休
- **痛点**: 子女不在身边, 孤独, 不会用复杂的智能设备
- **需求**:
  - 每天早上问好聊天
  - 提醒吃药和健康建议
  - 教她使用手机功能
- **使用场景**: 早上7点语音问好, 下午逛菜市场时询问菜价和营养搭配
- **付费意愿**: 子女代付 ¥19.9/月

### 3.2 用户需求优先级

| 需求类型 | P0 (必须有) | P1 (重要) | P2 (锦上添花) | P3 (未来) |
|---------|------------|----------|--------------|----------|
| **情感陪伴** | 文字对话, 情感识别 | 语音对话, 情绪安慰 | 视频通话, 表情动画 | VR见面 |
| **知识服务** | 问答能力, 知识库 | 学习辅导, 记忆用户偏好 | 主动推荐学习内容 | AR教学 |
| **购物助手** | - | 商品推荐, 比价 | 穿搭建议, 营养分析 | AR试穿 |
| **数字人形象** | 2D头像, 基础动画 | 3D写实形象, 口型同步 | 多套服装, 场景切换 | 进入3D世界 |
| **多终端** | Web端 | 移动App | 小程序 | 智能音箱/VR设备 |

---

## 4. 产品定位

### 4.1 产品定位陈述

MindPal是一款**面向全人类的3D写实数字人交互平台**, 为用户提供**情感陪伴、知识服务、购物助手**三位一体的智能服务, 通过**多模态交互(语音+文字+视觉)** 和**个性化塑造**, 成为用户在数字世界的专属伴侣, 并面向元宇宙提供世界模型集成能力。

### 4.2 产品关键词

`数字人` `情感陪伴` `知识服务` `3D写实` `多模态交互` `个性化` `方言支持` `元宇宙就绪`

---

## 5. 核心功能

### 5.1 功能架构图

```
MindPal平台
├── 用户系统
│   ├── 手机号登录/注册
│   ├── 个人信息管理
│   └── 会员订阅管理
├── 数字人管理
│   ├── 创建数字人 (选择形象/性格/声音)
│   ├── 个性化配置 (擅长领域/语气/系统提示词)
│   ├── 数字人列表
│   └── 数字人详情
├── 对话交互
│   ├── 文字对话
│   ├── 语音对话 (ASR + TTS)
│   ├── 情感识别与表达
│   ├── 多轮对话上下文
│   ├── 对话历史查看
│   └── 长期记忆可视化
├── 知识服务
│   ├── 知识库管理 (上传文档/URL)
│   ├── RAG检索增强
│   ├── 知识问答
│   └── 学习辅导
├── 购物助手 (P1)
│   ├── 商品推荐
│   ├── 价格对比
│   └── 穿搭/营养建议
├── 3D数字人展示
│   ├── 3D写实形象渲染
│   ├── 口型同步
│   ├── 表情动画
│   └── 场景切换
└── 设置中心
    ├── 语音设置 (方言选择/音色)
    ├── 隐私设置 (数据加密/记忆管理)
    └── 通知设置
```

### 5.2 功能优先级矩阵

| 功能模块 | P0 (6个月MVP) | P1 (+3个月) | P2 (+3个月) | P3 (+6个月) |
|---------|--------------|------------|------------|------------|
| **用户系统** | 手机号登录, 基础信息 | 第三方登录 | 多设备同步 | 元宇宙身份 |
| **数字人管理** | 创建/配置, 2D形象 | 3D写实形象, 多套装 | 自定义形象上传 | 动作捕捉 |
| **对话交互** | 文字对话, 情感识别 | 语音对话, 长期记忆 | 视频通话, 主动问候 | VR交互 |
| **知识服务** | 基础问答, 文档上传 | RAG检索, 学习辅导 | 主动推荐, 知识图谱可视化 | AR教学 |
| **购物助手** | - | 商品推荐, 比价 | 穿搭建议, 营养分析 | AR试穿 |
| **多终端** | Web端 | 移动App (iOS/Android) | 小程序 | 智能音箱/VR |
| **AI能力** | LLM对话, 情感分析 | ASR/TTS, 202方言 | 情绪趋势分析 | 世界模型集成 |

---

## 6. 页面架构

### 6.1 Web端页面结构 (P0 - MVP)

```
Web端 (React + TypeScript)
├── 公开页面
│   ├── 首页 (Landing Page)                  [P0]
│   ├── 登录页                                [P0]
│   └── 注册页                                [P0]
├── 用户主界面
│   ├── 主对话页 (数字人交互中心)             [P0] ⭐核心页面
│   ├── 数字人管理页                          [P0]
│   │   ├── 数字人列表                        [P0]
│   │   ├── 创建数字人 (多步骤表单)           [P0]
│   │   └── 数字人详情/编辑                   [P0]
│   ├── 对话历史页                            [P0]
│   ├── 知识库管理页                          [P0]
│   │   ├── 知识库列表                        [P0]
│   │   └── 上传文档/添加URL                  [P0]
│   ├── 个人中心                              [P0]
│   │   ├── 个人资料                          [P0]
│   │   ├── 会员订阅                          [P0]
│   │   └── 设置 (语音/隐私/通知)             [P0]
│   └── 记忆可视化页 (知识图谱)               [P2]
└── 其他
    └── 404页面                               [P0]
```

### 6.2 移动端页面结构 (P1)

```
移动App (React Native / Flutter)
├── Tab导航
│   ├── 【对话】 Tab                          [P1] ⭐核心Tab
│   │   └── 主对话页 (全屏数字人)
│   ├── 【数字人】 Tab                        [P1]
│   │   ├── 数字人卡片列表
│   │   └── 创建/编辑数字人
│   ├── 【知识库】 Tab                        [P1]
│   │   └── 知识库管理
│   └── 【我的】 Tab                          [P1]
│       ├── 个人资料
│       ├── 会员订阅
│       ├── 对话历史
│       └── 设置
├── 独立页面
│   ├── 登录/注册页                           [P1]
│   ├── 引导页 (首次使用)                     [P1]
│   └── 语音权限引导                          [P1]
```

### 6.3 小程序页面结构 (P2)

```
微信小程序
├── 首页 (简化版对话页)                       [P2]
├── 数字人列表页                              [P2]
├── 我的页                                    [P2]
└── 授权登录页                                [P2]
```

---

## 7. 详细页面需求

### 7.1 【P0 - 核心页面】主对话页 (数字人交互中心)

**页面定位**: MindPal的**灵魂页面**, 用户与数字人进行情感陪伴、知识问答、购物咨询的主要场所

#### 7.1.1 页面布局

```
+--------------------------------------------------+
|  [顶部栏]                                         |
|  < 返回  |  数字人名称: 小艾  |  ⚙️设置  📊状态   |
+--------------------------------------------------+
|                                                  |
|  [数字人展示区 - 占60%屏幕高度]                   |
|                                                  |
|          +------------------+                    |
|          |                  |                    |
|          |   3D数字人形象    |  (P0用2D头像)      |
|          |   实时口型同步    |  (P1升级3D)        |
|          |   情绪表情动画    |                    |
|          |                  |                    |
|          +------------------+                    |
|                                                  |
|  情绪指示器: 😊 开心 (当前情绪状态)               |
|                                                  |
+--------------------------------------------------+
|  [对话气泡区 - 占30%屏幕高度, 可滚动]             |
|                                                  |
|  你: 今天工作好累啊...                           |
|  小艾: 辛苦了呢~要不要和我聊聊发生了什么?😊       |
|  你: 老板又加需求了                              |
|  小艾: 我能理解你的压力,要学会适当拒绝哦💪        |
|                                                  |
+--------------------------------------------------+
|  [输入区]                                         |
|  +--------------------------------------------+  |
|  | 🎤 [输入框: 说点什么吧...]  😊 📎 ✈️     |  |
|  +--------------------------------------------+  |
+--------------------------------------------------+
```

#### 7.1.2 功能模块

**1. 数字人展示区**
- **P0 (MVP)**:
  - 2D头像 (512x512 圆形/方形可选)
  - 简单呼吸动画 (上下浮动)
  - 情绪状态文字显示 (开心/难过/平静等)
- **P1 (3个月后)**:
  - 3D写实数字人 (Unity WebGL / Unreal Pixel Streaming)
  - 口型同步 (通过TTS音素驱动)
  - 表情动画 (喜/怒/哀/乐 7种基础表情)
- **P2**:
  - 多套服装切换
  - 场景背景切换 (客厅/咖啡厅/星空等)
- **P3**:
  - 全身动作 (挥手/点头/拥抱等)
  - 进入3D世界 (Genie 3集成)

**2. 对话气泡区**
- 消息类型:
  - 用户消息 (右侧, 蓝色气泡)
  - 数字人消息 (左侧, 白色气泡)
  - 系统消息 (居中, 灰色, 如"小艾正在思考...")
- 消息内容支持:
  - 纯文字
  - Markdown渲染 (加粗/代码块等)
  - 图片 (P1)
  - 语音消息 (P1, 可播放)
  - 商品卡片 (P1购物助手)
- 交互:
  - 长按消息: 复制/删除/收藏
  - 点击消息时间戳: 显示详细时间
  - 滚动到底部按钮 (新消息提醒)

**3. 输入区**
- **文字输入**:
  - 占位符文案: "说点什么吧..." (可根据上下文动态变化, 如"今天心情怎么样?")
  - 输入时自动扩展为多行 (最多5行)
  - 回车发送 (Shift+回车换行)
- **语音输入** (P0):
  - 点击🎤图标: 开始录音 (最长60秒)
  - 实时显示录音波形动画
  - 上滑取消, 松手发送
  - ASR识别后显示文字并发送
- **表情/贴图** (P1):
  - 点击😊图标: 打开表情面板
  - 支持Emoji + 自定义贴图
- **附件上传** (P1):
  - 点击📎图标: 上传图片/文档
  - 用于知识库补充或购物咨询
- **发送按钮**:
  - 输入框为空时: 显示🎤 (切换为语音模式)
  - 输入框有内容时: 显示✈️ (发送文字)

**4. 顶部栏功能**
- **返回按钮**: 返回数字人列表
- **数字人名称**: 显示当前对话的数字人, 点击查看详情
- **设置按钮**:
  - 对话设置 (清空历史/导出对话)
  - 切换数字人
  - 语音设置 (方言/音色/语速)
- **状态按钮** (📊):
  - 显示情绪趋势图 (P1)
  - 显示记忆可视化 (P2)

#### 7.1.3 核心交互流程

**流程1: 文字对话**
1. 用户在输入框输入: "今天好累"
2. 点击发送, 消息显示在右侧气泡
3. 数字人头像显示"思考中"动画 (P0: 加载圈, P1: 眨眼动画)
4. 系统调用情感识别: 检测到"疲惫"情绪
5. 数字人表情切换为"关心" (P1: 3D表情, P0: 文字"关心😟")
6. 数字人回复: "辛苦了呢~要不要和我聊聊发生了什么?" (左侧气泡逐字打印效果)
7. 用户继续输入...

**流程2: 语音对话** (P0)
1. 用户长按🎤按钮
2. 弹出录音界面, 显示波形动画和"松手发送, 上滑取消"
3. 用户说话: "今天工作好累啊"
4. 松手后, 显示"识别中..."
5. ASR识别完成, 显示文字"今天工作好累啊"在右侧气泡
6. 同时自动发送给数字人
7. 数字人语音回复 (TTS生成), 同时显示文字气泡
8. 用户可点击🔊图标重新播放语音

**流程3: 知识问答** (P0)
1. 用户输入: "什么是相对论?"
2. 系统识别意图为"知识查询"
3. 调用RAG检索知识库 (如果用户上传过物理文档, 优先检索)
4. 数字人回复: "相对论是爱因斯坦提出的物理理论..." (附带知识来源标签)
5. 用户追问: "能举个例子吗?"
6. 数字人基于上下文继续回答

**流程4: 情感陪伴** (P0)
1. 用户输入: "我失恋了,好难过"
2. 系统情感识别: "悲伤" 0.92强度
3. 数字人切换情绪状态为"安慰模式"
4. 回复: "我能感受到你的难过💙,失恋真的很痛苦对吗?我会一直陪着你的"
5. 系统记录情感日志到数据库 (用于P1情绪趋势分析)

#### 7.1.4 数据接口 (前后端对接)

**发送消息 API**
```
POST /api/v1/conversations/message
Request:
{
  "digital_human_id": 123,
  "message_type": "text",  // text / voice
  "content": "今天好累",
  "voice_file_url": null   // 如果是语音消息, 传OSS URL
}

Response:
{
  "code": 0,
  "data": {
    "message_id": 456,
    "reply": "辛苦了呢~要不要和我聊聊发生了什么?",
    "emotion_detected": "tired",  // 检测到的用户情绪
    "emotion_intensity": 0.75,
    "dh_emotion": "caring",       // 数字人表情
    "tts_audio_url": "https://oss.../reply_456.mp3",  // 语音回复URL (P1)
    "created_at": "2025-01-11T20:30:00Z"
  }
}
```

**获取对话历史 API**
```
GET /api/v1/conversations/history?digital_human_id=123&limit=50&offset=0

Response:
{
  "code": 0,
  "data": {
    "messages": [
      {
        "id": 1,
        "role": "user",
        "content": "今天好累",
        "emotion": "tired",
        "created_at": "2025-01-11T20:25:00Z"
      },
      {
        "id": 2,
        "role": "assistant",
        "content": "辛苦了呢~要不要和我聊聊发生了什么?",
        "dh_emotion": "caring",
        "tts_audio_url": "https://...",
        "created_at": "2025-01-11T20:25:05Z"
      }
    ],
    "total": 128
  }
}
```

---

### 7.2 【P0】数字人管理页

#### 7.2.1 数字人列表页

**页面目标**: 展示用户创建的所有数字人, 支持快速切换对话对象

**布局**:
```
+--------------------------------------------------+
|  我的数字人                      [+ 创建新数字人]  |
+--------------------------------------------------+
|  [数字人卡片1]                                    |
|  +------+  小艾                                   |
|  | 头像 |  性格: 温柔体贴 | 对话: 128次           |
|  +------+  最后对话: 2小时前                      |
|           [开始对话]  [编辑]                      |
+--------------------------------------------------+
|  [数字人卡片2]                                    |
|  +------+  小智                                   |
|  | 头像 |  性格: 博学严谨 | 对话: 56次            |
|  +------+  最后对话: 1天前                        |
|           [开始对话]  [编辑]                      |
+--------------------------------------------------+
|  (最多创建5个数字人, 会员10个)                    |
+--------------------------------------------------+
```

**功能**:
- 显示数字人头像、名称、性格标签、对话次数、最后对话时间
- 点击"开始对话": 跳转到主对话页
- 点击"编辑": 进入数字人详情/编辑页
- 点击"+ 创建新数字人": 跳转到创建数字人流程
- 限制: 免费用户最多5个数字人, 会员10个

---

#### 7.2.2 创建数字人页 (多步骤表单)

**步骤流程**:
```
Step 1: 选择形象  →  Step 2: 设置性格  →  Step 3: 选择声音  →  Step 4: 擅长领域  →  Step 5: 完成
```

**Step 1: 选择形象**
- 显示预设的6-8个2D头像 (P0)
  - 类型: 女性温柔型、男性阳光型、女性知性型、男性稳重型等
  - 点击选中, 高亮边框
- P1: 支持3D形象选择 (显示3D预览)
- P2: 支持用户上传自定义头像

**Step 2: 设置性格**
- 输入数字人名称 (必填, 2-10个字符)
- 选择性格特质 (单选):
  - 温柔体贴 😊
  - 幽默风趣 😄
  - 专业严谨 🤓
  - 活泼开朗 🌟
  - 沉稳内敛 😌
- 选择语气风格 (单选):
  - 亲切自然
  - 轻松活泼
  - 沉稳专业

**Step 3: 选择声音** (P0)
- 播放6-8种预设音色 (点击🔊试听 5秒示例)
  - 女声1: 温柔甜美 (阿里云-小美)
  - 女声2: 知性优雅 (讯飞-小燕)
  - 男声1: 阳光活力 (字节-小明)
  - 男声2: 磁性低沉 (百度-小伟)
  - ...
- 方言选择 (P1, 默认普通话):
  - 下拉框: 普通话 / 粤语 / 四川话 / 东北话 / ... (202种)

**Step 4: 擅长领域**
- 多选框 (可选0-5个):
  - ✅ 情感陪伴
  - ✅ 学习辅导 (数学/物理/英语等)
  - ✅ 健康咨询
  - ✅ 购物建议 (P1)
  - ✅ 旅游规划
  - ✅ 职业咨询
- 自定义输入框: "其他擅长领域" (选填, 如"心理咨询")

**Step 5: 完成**
- 显示数字人预览卡片
- 确认信息无误后点击"创建数字人"
- 创建成功后跳转到主对话页, 自动发送第一条消息:
  - 数字人: "你好呀~我是{名称}, 很高兴认识你!😊 有什么可以帮到你的吗?"

**数据接口**:
```
POST /api/v1/digital-humans
Request:
{
  "name": "小艾",
  "avatar_url": "https://oss.../avatar_01.png",
  "model_type": "2d",
  "personality": "friendly",  // friendly/professional/humorous/gentle
  "tone": "warm",             // warm/professional/playful
  "voice_id": "aliyun_xiaomei",
  "dialect": "mandarin",      // P1
  "expertise": ["companionship", "learning", "health"]
}

Response:
{
  "code": 0,
  "data": {
    "digital_human_id": 123,
    "name": "小艾",
    "created_at": "2025-01-11T20:00:00Z"
  }
}
```

---

#### 7.2.3 数字人详情/编辑页

**页面布局**:
```
+--------------------------------------------------+
|  < 返回               数字人详情          [删除]  |
+--------------------------------------------------+
|          +------------------+                    |
|          |     数字人头像    |                    |
|          +------------------+                    |
|                 小艾                              |
+--------------------------------------------------+
|  [基础信息]                                       |
|  名称:        [小艾_____________________]         |
|  性格:        温柔体贴 ▼                          |
|  语气:        亲切自然 ▼                          |
|  声音:        阿里云-小美 🔊 ▼                    |
|  方言:        普通话 ▼           (P1)             |
+--------------------------------------------------+
|  [擅长领域]                                       |
|  ☑ 情感陪伴  ☑ 学习辅导  ☐ 健康咨询              |
|  ☐ 购物建议  ☐ 旅游规划  ☐ 职业咨询              |
+--------------------------------------------------+
|  [高级设置] (展开/收起)                           |
|  系统提示词 (选填, 高级用户):                     |
|  [你是一个温柔体贴的数字人,名叫小艾...]           |
|  [多行文本框, 最多500字]                          |
+--------------------------------------------------+
|  [统计信息]                                       |
|  对话次数: 128次                                  |
|  创建时间: 2025-01-05 10:30                      |
|  最后对话: 2小时前                                |
+--------------------------------------------------+
|           [保存修改]   [开始对话]                 |
+--------------------------------------------------+
```

**功能**:
- 修改数字人名称、性格、语气、声音、擅长领域
- 高级用户可自定义系统提示词 (影响对话风格)
- 显示统计信息 (对话次数、创建时间)
- 删除数字人 (二次确认弹窗)

---

### 7.3 【P0】知识库管理页

**页面目标**: 用户上传个人文档/网页链接, 数字人通过RAG检索回答专属知识

**页面布局**:
```
+--------------------------------------------------+
|  知识库管理                  [+ 添加知识]         |
+--------------------------------------------------+
|  [知识库列表]                                     |
|                                                  |
|  📄 相对论笔记.pdf           2.3 MB  [删除]      |
|     上传时间: 2025-01-10                         |
|     已向量化: 128段落                             |
|                                                  |
|  🔗 维基百科-量子力学         [删除]              |
|     https://zh.wikipedia.org/wiki/量子力学       |
|     已向量化: 56段落                              |
|                                                  |
|  📄 我的旅行日记.docx        1.8 MB  [删除]      |
|     上传时间: 2025-01-08                         |
|     处理中...                                     |
|                                                  |
+--------------------------------------------------+
|  提示: 上传的文档会被拆分并存储到向量数据库,      |
|  数字人对话时会优先检索你的知识库来回答问题。    |
+--------------------------------------------------+
```

**功能**:
- **添加知识**:
  - 点击"+ 添加知识", 弹出选择:
    - 📁 上传文档 (支持 .pdf / .docx / .txt, 单文件最大10MB)
    - 🔗 添加URL (支持网页/博客/维基百科)
  - 上传后显示处理状态: "处理中..." → "已向量化"
- **知识库列表**:
  - 显示文档名称、大小、上传时间、向量化段落数
  - 点击文档名称: 预览文档内容 (P1)
  - 点击"删除": 二次确认后删除 (同时删除向量数据库中的嵌入)
- **限制**:
  - 免费用户: 最多上传10个文档, 总大小50MB
  - 会员用户: 最多100个文档, 总大小500MB

**数据接口**:
```
POST /api/v1/knowledge-base/upload
Request: FormData
{
  file: [File对象],
  digital_human_id: 123
}

Response:
{
  "code": 0,
  "data": {
    "knowledge_id": 789,
    "filename": "相对论笔记.pdf",
    "status": "processing",  // processing / completed / failed
    "file_size": 2359296,
    "created_at": "2025-01-11T20:00:00Z"
  }
}

POST /api/v1/knowledge-base/url
Request:
{
  "url": "https://zh.wikipedia.org/wiki/量子力学",
  "digital_human_id": 123
}

Response: (同上)
```

---

### 7.4 【P0】登录/注册页

**登录页布局**:
```
+--------------------------------------------------+
|                   MindPal                        |
|              你的专属数字人伴侣                   |
|                                                  |
|          +------------------+                    |
|          |  数字人形象动画   |                    |
|          +------------------+                    |
|                                                  |
|  [手机号登录]                                     |
|  +--------------------------------------------+  |
|  | 📱 [手机号输入框___________________]      |  |
|  +--------------------------------------------+  |
|  +--------------------------------------------+  |
|  | 🔑 [验证码输入框_______]  [获取验证码]    |  |
|  +--------------------------------------------+  |
|                                                  |
|            [登录 / 注册]                         |
|                                                  |
|  登录即代表同意 《用户协议》和《隐私政策》        |
|                                                  |
+--------------------------------------------------+
```

**功能**:
- 手机号验证码登录 (无需密码)
- 点击"获取验证码": 60秒倒计时
- 验证码输入后自动校验格式
- 登录成功后:
  - 如果是新用户: 跳转到"创建第一个数字人"引导页
  - 如果是老用户: 跳转到数字人列表页

**新用户引导页** (仅首次):
```
+--------------------------------------------------+
|             欢迎来到 MindPal! 👋                 |
|                                                  |
|  让我们开始创建你的第一个专属数字人吧~            |
|                                                  |
|  你希望Ta是什么样的?                              |
|  [ ] 温柔体贴,像闺蜜一样倾听我                   |
|  [ ] 博学严谨,帮我学习和解答问题                 |
|  [ ] 幽默风趣,陪我聊天解闷                       |
|                                                  |
|            [开始创建]  [稍后再说]                |
+--------------------------------------------------+
```

---

### 7.5 【P0】个人中心

**页面布局**:
```
+--------------------------------------------------+
|  < 返回                 个人中心                  |
+--------------------------------------------------+
|  [用户信息卡片]                                   |
|  +------+  李小明                                |
|  | 头像 |  手机: 138****8000                     |
|  +------+  会员: 免费版 [升级会员]               |
+--------------------------------------------------+
|  [功能入口]                                       |
|  📊 我的数据                                     |
|     对话次数: 128次 | 使用天数: 15天              |
|                                                  |
|  💎 会员订阅                                     |
|     查看会员权益和订阅管理 >                      |
|                                                  |
|  ⚙️ 设置                                         |
|     语音设置 / 隐私设置 / 通知设置 >              |
|                                                  |
|  📜 对话历史                                     |
|     查看所有数字人的对话记录 >                    |
|                                                  |
|  ❓ 帮助中心                                     |
|     常见问题 / 使用教程 >                         |
|                                                  |
|  📄 关于我们                                     |
|     用户协议 / 隐私政策 / 版本号 v1.0.0          |
|                                                  |
|  [退出登录]                                       |
+--------------------------------------------------+
```

**会员订阅页**:
```
+--------------------------------------------------+
|  会员订阅                                         |
+--------------------------------------------------+
|  [免费版]               [会员版 ⭐]               |
|  ¥0/月                  ¥19.9/月 或 ¥199/年      |
|                                                  |
|  数字人数量: 5个         数字人数量: 10个         |
|  知识库: 50MB           知识库: 500MB            |
|  对话次数: 每天100次     对话次数: 无限           |
|  3D形象: ❌             3D形象: ✅                |
|  语音对话: 每天10次      语音对话: 无限           |
|  情绪分析: 基础          情绪分析: 深度报告       |
|                         优先体验新功能            |
|                                                  |
|         [当前版本]              [立即订阅]        |
+--------------------------------------------------+
```

**设置页**:
- **语音设置**:
  - 默认方言: 普通话 ▼
  - 语速: 慢 | 正常 | 快
  - 音量: 滑块调节
- **隐私设置**:
  - ✅ 启用端到端加密
  - ✅ 允许数字人记忆我的偏好
  - ☐ 允许匿名数据用于产品改进
  - [清空所有对话记录] (二次确认)
  - [导出我的数据]
- **通知设置**:
  - ✅ 数字人主动问候 (每天早上8点)
  - ☐ 情绪异常提醒 (连续3天负面情绪时提醒)

---

### 7.6 【P1】移动端核心页面

移动端与Web端功能一致, 但布局优化为全屏沉浸式体验

**主对话页 (移动端)**:
- 数字人占满屏幕 (全屏3D形象)
- 对话气泡半透明悬浮在底部
- 支持手势: 双击数字人头部=放大, 左右滑动=切换数字人

---

### 7.7 【P2】记忆可视化页 (知识图谱)

**页面目标**: 用户可以看到数字人对自己的理解, 以知识图谱形式展示

**页面布局**:
```
+--------------------------------------------------+
|  < 返回        小艾对你的理解        [导出]      |
+--------------------------------------------------+
|                                                  |
|  [知识图谱可视化 - D3.js / ECharts]              |
|                                                  |
|           你 (中心节点)                          |
|            /    |    \                           |
|         /       |       \                        |
|      职业     兴趣爱好    情感状态                |
|    产品经理   摄影/旅游   最近压力大              |
|                                                  |
|  点击节点: 显示详细信息和对话来源                 |
|                                                  |
+--------------------------------------------------+
```

**功能**:
- 自动从对话历史中提取关键信息构建图谱
- 节点类型: 个人信息 / 兴趣爱好 / 情感状态 / 关系网络
- 点击节点: 显示该信息的来源对话 (可溯源)
- 导出为图片分享

---

## 8. 用户故事

### 8.1 P0 (MVP核心功能)

| ID | 用户故事 | 验收标准 | 优先级 |
|----|---------|---------|--------|
| US-001 | 作为用户, 我希望用手机号快速登录, 无需记密码 | - 输入手机号和验证码后能成功登录<br>- 验证码60秒有效期<br>- 新用户自动创建账号 | P0 |
| US-002 | 作为新用户, 我希望快速创建第一个数字人并开始对话 | - 5步创建流程不超过2分钟<br>- 创建后自动进入对话页<br>- 数字人主动发送欢迎消息 | P0 |
| US-003 | 作为用户, 我希望通过文字与数字人对话, 获得情感共鸣 | - 消息发送延迟<2秒<br>- 数字人能识别我的情绪(开心/难过/焦虑)<br>- 回复内容贴合我的情绪状态 | P0 |
| US-004 | 作为学生, 我希望向数字人提问学习问题, 获得清晰解答 | - 数字人能回答数学/物理/英语等学科问题<br>- 回答准确率>85%<br>- 支持追问和举例 | P0 |
| US-005 | 作为用户, 我希望上传自己的笔记, 让数字人基于我的知识回答 | - 支持上传PDF/DOCX/TXT<br>- 上传后5分钟内完成向量化<br>- 对话时优先检索我的文档 | P0 |
| US-006 | 作为用户, 我希望通过语音与数字人对话, 解放双手 | - 长按录音, 松手发送<br>- ASR识别准确率>90%<br>- TTS语音自然流畅 | P0 |
| US-007 | 作为用户, 我希望查看历史对话记录, 回顾过往 | - 支持按数字人筛选历史<br>- 支持按日期筛选<br>- 支持关键词搜索 | P0 |
| US-008 | 作为用户, 我希望修改数字人的性格和声音, 满足个性化需求 | - 能修改名称/性格/语气/声音/擅长领域<br>- 修改后立即生效<br>- 不影响历史对话 | P0 |

### 8.2 P1 (重要功能)

| ID | 用户故事 | 验收标准 | 优先级 |
|----|---------|---------|--------|
| US-009 | 作为用户, 我希望看到3D写实数字人, 获得更真实的陪伴感 | - 3D形象加载时间<5秒<br>- 支持口型同步<br>- 支持7种基础表情动画 | P1 |
| US-010 | 作为用户, 我希望数字人用我的家乡方言说话, 更有亲切感 | - 支持202种中国方言<br>- 方言TTS自然度>80分<br>- 可随时切换方言 | P1 |
| US-011 | 作为用户, 我希望数字人主动问候我, 让我感受到被关心 | - 每天早上8点发送问候消息<br>- 问候内容个性化(基于历史对话)<br>- 可在设置中关闭 | P1 |
| US-012 | 作为用户, 我希望看到我的情绪趋势图, 了解自己的心理状态 | - 显示最近7天/30天情绪曲线<br>- 标注情绪异常日期<br>- 提供情绪改善建议 | P1 |
| US-013 | 作为用户, 我希望数字人推荐适合我的商品, 提升购物体验 | - 基于对话内容推荐商品<br>- 显示价格对比<br>- 一键跳转购买链接 | P1 |
| US-014 | 作为用户, 我希望在手机App上使用, 随时随地对话 | - iOS/Android双端支持<br>- 支持推送通知<br>- 流量优化(语音压缩) | P1 |

### 8.3 P2 (锦上添花)

| ID | 用户故事 | 验收标准 | 优先级 |
|----|---------|---------|--------|
| US-015 | 作为用户, 我希望看到数字人对我的理解(知识图谱), 感受被记住 | - 自动提取个人信息节点<br>- 支持节点溯源到对话<br>- 支持图谱导出分享 | P2 |
| US-016 | 作为用户, 我希望给数字人换装和更换场景, 增加趣味性 | - 至少3套服装可选<br>- 至少5种场景(客厅/咖啡厅/星空等)<br>- 会员专属服装 | P2 |
| US-017 | 作为用户, 我希望在微信小程序快速使用, 无需下载App | - 小程序体积<2MB<br>- 核心对话功能完整<br>- 与App数据同步 | P2 |

### 8.4 P3 (未来愿景)

| ID | 用户故事 | 验收标准 | 优先级 |
|----|---------|---------|--------|
| US-018 | 作为用户, 我希望戴上VR头显与数字人面对面交流, 如《头号玩家》 | - VR设备支持<br>- 全身动作捕捉<br>- 空间音频 | P3 |
| US-019 | 作为用户, 我希望进入数字人创造的3D世界, 一起探险 | - 集成Genie 3世界模型<br>- 支持自然语言生成场景<br>- 多人同时进入 | P3 |

---

## 9. 用户流程

### 9.1 新用户首次使用流程

```
用户打开网页/App
    ↓
看到Landing Page (展示MindPal介绍视频)
    ↓
点击"开始体验" → 跳转登录页
    ↓
输入手机号 → 获取验证码 → 登录
    ↓
[新用户引导页]
  "欢迎来到MindPal! 让我们创建你的第一个数字人~"
    ↓
选择数字人类型 (温柔体贴/博学严谨/幽默风趣)
    ↓
进入创建数字人流程 (5步表单)
  Step 1: 选择形象
  Step 2: 设置性格 (输入名称)
  Step 3: 选择声音 (试听音色)
  Step 4: 擅长领域
  Step 5: 完成
    ↓
创建成功 → 自动跳转到主对话页
    ↓
数字人主动发送第一条消息:
  "你好呀~我是小艾, 很高兴认识你!😊 有什么可以帮到你的吗?"
    ↓
用户开始对话...
```

### 9.2 老用户日常使用流程

```
用户打开App/网页 (已登录)
    ↓
进入数字人列表页
    ↓
选择一个数字人 → 点击"开始对话"
    ↓
进入主对话页 (加载最近10条历史消息)
    ↓
用户输入消息 / 语音输入
    ↓
数字人识别情绪 → 生成回复 → 显示在气泡
    ↓
用户继续对话...
    ↓
(可选) 点击顶部设置 → 切换方言/查看情绪趋势
    ↓
对话结束 → 返回数字人列表
```

### 9.3 上传知识库并提问流程

```
用户进入知识库管理页
    ↓
点击"+ 添加知识" → 选择"上传文档"
    ↓
选择本地PDF文件 (如: 《相对论笔记.pdf》)
    ↓
上传中... (显示进度条)
    ↓
上传成功 → 后台开始向量化处理
    ↓
5分钟后, 状态变为"已向量化: 128段落"
    ↓
用户返回主对话页
    ↓
向数字人提问: "相对论的核心思想是什么?"
    ↓
数字人调用RAG检索知识库 → 找到相关段落
    ↓
回复: "根据你的笔记, 相对论的核心思想是..." (附带来源标签)
    ↓
用户追问: "能举个例子吗?"
    ↓
数字人基于上下文继续回答...
```

---

## 10. 技术架构

### 10.1 系统架构图

```
+--------------------------------------------------+
|                   前端层                         |
|  Web (React)  |  App (RN/Flutter)  |  小程序     |
+--------------------------------------------------+
                       ↓ HTTPS
+--------------------------------------------------+
|                  API网关层                       |
|    Nginx + 负载均衡 + Rate Limiting              |
+--------------------------------------------------+
                       ↓
+--------------------------------------------------+
|                 业务逻辑层 (FastAPI)             |
|  用户服务 | 数字人服务 | 对话服务 | 知识库服务   |
+--------------------------------------------------+
         ↓                    ↓                ↓
+----------------+  +--------------------+  +----------+
|   数据层       |  |    AI服务层        |  | 缓存层   |
|  MySQL 8.0     |  |  LLM (Adapter)    |  | Redis    |
|  (主从复制)    |  |  ASR (Adapter)    |  | (会话)   |
|                |  |  TTS (Adapter)    |  |          |
|  向量数据库    |  |  情感识别         |  |          |
|  Qdrant/Milvus |  +--------------------+  +----------+
+----------------+           ↓
                   +--------------------+
                   |  第三方AI厂商      |
                   |  阿里云 / 字节     |
                   |  讯飞 / 百度       |
                   +--------------------+
```

### 10.2 核心技术栈

**前端**:
- **Web**: React 18 + TypeScript + Vite + TailwindCSS
- **移动端**: React Native (或 Flutter, 待定)
- **小程序**: 原生微信小程序
- **3D渲染**: Unity WebGL (P1) 或 Three.js (P0轻量级)
- **状态管理**: Zustand / Redux Toolkit
- **UI组件库**: Ant Design / shadcn/ui

**后端**:
- **框架**: FastAPI (Python 3.11+)
- **数据库**: MySQL 8.0 (主) + Redis 7.0 (缓存/会话)
- **向量数据库**: Qdrant (P0) 或 Milvus (P1扩展)
- **异步任务**: Celery + RabbitMQ
- **API文档**: Swagger / ReDoc (自动生成)

**AI服务** (Adapter适配器模式):
- **LLM**:
  - 阿里云通义千问
  - 字节豆包
  - 讯飞星火
  - 百度文心 (默认)
- **ASR**: 阿里云 / 讯飞 (202方言)
- **TTS**: 多厂商音色库
- **情感识别**: 自研模型 (基于BERT fine-tune) 或 调用厂商API
- **RAG框架**: LangChain + Qdrant

**基础设施**:
- **容器化**: Docker + Docker Compose
- **CI/CD**: GitHub Actions
- **监控**: Prometheus + Grafana
- **日志**: ELK (Elasticsearch + Logstash + Kibana)
- **CDN**: 阿里云CDN (静态资源)
- **对象存储**: 阿里云OSS (头像/语音文件/文档)

### 10.3 数据库设计 (核心表)

详见 `db_engineer.md` 提示词, 这里列出9张核心表:

1. **users** (用户表)
2. **digital_humans** (数字人表)
3. **subscriptions** (订阅表)
4. **knowledge_base** (知识库表)
5. **conversations** (对话表)
6. **messages** (消息表)
7. **emotion_logs** (情感日志表)
8. **user_preferences** (用户偏好表)
9. **system_logs** (系统日志表)

### 10.4 AI服务适配器设计

**目标**: 支持灵活切换AI厂商, 降低供应商依赖

**代码示例**:
```python
# app/services/ai/adapters/base.py
from abc import ABC, abstractmethod

class BaseLLMAdapter(ABC):
    @abstractmethod
    async def generate_response(self, prompt: str, context: list) -> str:
        pass

# app/services/ai/adapters/aliyun_adapter.py
class AliyunLLMAdapter(BaseLLMAdapter):
    async def generate_response(self, prompt: str, context: list) -> str:
        # 调用阿里云通义千问API
        ...

# app/services/ai/adapters/baidu_adapter.py
class BaiduLLMAdapter(BaseLLMAdapter):
    async def generate_response(self, prompt: str, context: list) -> str:
        # 调用百度文心API
        ...

# app/services/ai/llm_service.py
class LLMService:
    def __init__(self, provider: str = "baidu"):
        self.adapter = self._get_adapter(provider)

    def _get_adapter(self, provider: str) -> BaseLLMAdapter:
        adapters = {
            "aliyun": AliyunLLMAdapter(),
            "baidu": BaiduLLMAdapter(),
            ...
        }
        return adapters.get(provider, BaiduLLMAdapter())
```

### 10.5 数据安全架构

- **传输加密**: 全站HTTPS (TLS 1.3)
- **存储加密**:
  - 敏感字段 (手机号/对话内容) 使用AES-256加密
  - 密钥存储在环境变量, 不提交代码仓库
- **租户隔离**:
  - 数据库行级隔离 (WHERE user_id = ?)
  - Redis key前缀隔离 (user:{user_id}:*)
- **权限控制**:
  - JWT token认证
  - 每个API检查token和资源所有权
- **隐私保护**:
  - 用户可随时删除所有对话记录
  - 可导出个人数据 (GDPR合规)
  - 向量数据库中的嵌入不包含明文

---

## 11. 分阶段实施路线图

### 11.1 P0阶段 (MVP - 6个月) - Web端 + 核心功能

**目标**: 上线可用的Web端产品, 验证情感陪伴+知识服务核心价值

**时间**: 2025年1月 - 2025年6月

**核心功能**:
- ✅ 手机号登录/注册
- ✅ 创建数字人 (2D头像 + 性格配置)
- ✅ 文字对话 (LLM集成)
- ✅ 语音对话 (ASR + TTS)
- ✅ 情感识别 (文本情绪分析)
- ✅ 知识库上传 (PDF/DOCX/TXT)
- ✅ RAG检索 (Qdrant + LangChain)
- ✅ 对话历史查看
- ✅ 个人中心 (资料/设置)
- ✅ 会员订阅系统

**技术实现**:
- 前端: React + TypeScript + TailwindCSS
- 后端: FastAPI + MySQL + Redis + Celery
- AI: 百度文心 (默认LLM) + 阿里云ASR/TTS
- 部署: Docker + 单服务器

**里程碑**:
- M1 (2个月): 用户系统 + 数字人管理 + 文字对话
- M2 (2个月): 语音对话 + 情感识别 + 知识库RAG
- M3 (2个月): 个人中心 + 会员系统 + 性能优化 + 内测

**成功指标**:
- 注册用户 1000+
- 日活用户 100+
- 对话次数 10000+
- 用户留存率 (次日) > 40%
- NPS (净推荐值) > 30

---

### 11.2 P1阶段 (+3个月) - 移动端 + 购物助手 + 3D数字人

**目标**: 扩展到移动端, 增加购物助手, 升级3D写实数字人

**时间**: 2025年7月 - 2025年9月

**新增功能**:
- ✅ iOS/Android App (React Native)
- ✅ 3D写实数字人 (Unity WebGL)
- ✅ 口型同步 + 表情动画
- ✅ 202种方言支持 (科大讯飞集成)
- ✅ 购物助手 (商品推荐 + 比价)
- ✅ 主动问候 (每天早上8点)
- ✅ 情绪趋势分析 (7天/30天曲线图)
- ✅ 图片消息支持
- ✅ 多设备同步

**技术升级**:
- 3D引擎: Unity WebGL + Pixel Streaming
- 方言TTS: 科大讯飞202方言
- 购物API: 对接淘宝/京东/拼多多开放平台
- 推送通知: Firebase (iOS) + JPush (Android)

**里程碑**:
- M4 (1.5个月): App开发 + 3D数字人集成
- M5 (1.5个月): 方言支持 + 购物助手 + 公测

**成功指标**:
- 总用户 10000+
- 日活用户 1000+
- App Store/Google Play 评分 > 4.5
- 购物转化率 > 5%
- 语音对话占比 > 30%

---

### 11.3 P2阶段 (+3个月) - 小程序 + 智能设备 + 记忆可视化

**目标**: 覆盖更多终端, 增强个性化和可视化

**时间**: 2025年10月 - 2025年12月

**新增功能**:
- ✅ 微信小程序
- ✅ 支付宝小程序
- ✅ 智能音箱适配 (小度/天猫精灵)
- ✅ 记忆可视化 (知识图谱)
- ✅ 数字人换装 (3套服装)
- ✅ 场景切换 (5种背景)
- ✅ AR虚拟形象 (手机摄像头)
- ✅ 多数字人协同对话

**技术升级**:
- 小程序: 原生开发 (支持分包加载)
- 知识图谱: D3.js / ECharts
- AR: ARKit (iOS) + ARCore (Android)

**里程碑**:
- M6 (1.5个月): 小程序 + 智能设备
- M7 (1.5个月): 记忆可视化 + AR + 全量发布

**成功指标**:
- 总用户 50000+
- 付费用户 5000+ (转化率10%)
- 小程序DAU 2000+
- 用户月均对话次数 > 50次

---

### 11.4 P3阶段 (+6个月) - 元宇宙集成 + 世界模型

**目标**: 接入Google Genie 3等世界模型, 实现《头号玩家》愿景

**时间**: 2026年1月 - 2026年6月

**新增功能**:
- ✅ VR设备支持 (Quest 3 / Vision Pro)
- ✅ 世界模型集成 (Genie 3 / 国产替代)
- ✅ 全身动作捕捉
- ✅ 多人同时进入数字世界
- ✅ 空间音频
- ✅ 数字人自主学习 (强化学习)
- ✅ 开放平台 (第三方开发者接入)

**技术突破**:
- 世界模型: Genie 3 API集成
- VR: Unity VR / Unreal Engine 5
- 动捕: MediaPipe / Azure Kinect
- 分布式: K8s + 微服务拆分

**里程碑**:
- M8 (3个月): VR版本 + 世界模型POC
- M9 (3个月): 多人协同 + 开放平台 + 生态发布

**成功指标**:
- 总用户 200000+
- VR用户 10000+
- 第三方开发者 100+
- 成为数字人领域头部产品

---

## 12. 数据安全与隐私

### 12.1 数据加密

| 数据类型 | 加密方式 | 密钥管理 |
|---------|---------|---------|
| 传输数据 | HTTPS (TLS 1.3) | Let's Encrypt自动续签 |
| 手机号 | AES-256-CBC | 环境变量 (不提交代码) |
| 对话内容 | AES-256-GCM (端到端可选) | 用户密钥 + 服务端密钥 |
| 文档内容 | 服务端加密 (静态) | 阿里云OSS服务端加密 |
| 向量嵌入 | 不加密 (已脱敏) | - |

### 12.2 租户隔离

- **数据库**: 所有查询必须带 `WHERE user_id = ?`
- **Redis**: Key前缀隔离 `user:{user_id}:session`
- **向量数据库**: Collection按user_id分区
- **对象存储**: 路径隔离 `oss://mindpal/users/{user_id}/`

### 12.3 隐私保护

- **用户权利**:
  - ✅ 查看我的数据 (导出JSON)
  - ✅ 删除我的数据 (软删除 + 30天后物理删除)
  - ✅ 关闭记忆功能 (不存储长期记忆)
  - ✅ 选择退出数据分析 (不用于产品改进)

- **合规**:
  - 遵守《个人信息保护法》
  - 参考GDPR标准 (为未来出海准备)
  - 隐私政策透明化 (简洁版 + 完整版)

### 12.4 安全审计

- **日志记录**: 所有API请求记录到system_logs表
- **异常监控**:
  - 连续登录失败 > 5次 → 锁定账号
  - 单用户QPS > 100 → 限流
  - 敏感操作 (删除数据) → 发送邮件通知
- **定期审计**: 每季度进行安全扫描 (SQL注入/XSS/CSRF)

---

## 13. 商业模式

### 13.1 定价策略

| 版本 | 价格 | 权益 |
|------|------|------|
| **免费版** | ¥0 | - 5个数字人<br>- 知识库50MB<br>- 每天100次对话<br>- 每天10次语音<br>- 2D头像<br>- 基础情感识别 |
| **会员版** | **¥19.9/月**<br>或<br>**¥199/年** (省¥40) | - 10个数字人<br>- 知识库500MB<br>- 无限对话<br>- 无限语音<br>- **3D写实形象**<br>- **202种方言**<br>- 深度情绪分析<br>- 优先体验新功能<br>- 专属客服 |
| **企业版** | 定制报价 | - 不限数字人<br>- 私有化部署<br>- 定制开发<br>- SLA保障<br>- 技术支持 |

### 13.2 收入来源

1. **订阅收入** (主要):
   - 目标: 第一年5000付费用户 × ¥199/年 = ¥99.5万
   - 第二年50000付费用户 × ¥199/年 = ¥995万

2. **购物分佣** (P1):
   - 淘宝/京东/拼多多 联盟分佣 (佣金率5-10%)
   - 目标: 月GMV ¥50万 × 8% = ¥4万/月

3. **企业服务** (P2):
   - 数字人定制 (如虚拟客服/虚拟主播)
   - 单项目 ¥10万-50万

4. **开放平台** (P3):
   - API调用费用 (¥0.01/次)
   - 第三方开发者分成 (3:7分成)

### 13.3 成本结构

| 成本项 | 月成本 (MVP阶段) | 年成本 |
|--------|-----------------|--------|
| 服务器 (阿里云) | ¥2000 | ¥24000 |
| AI服务 (LLM/ASR/TTS) | ¥5000 | ¥60000 |
| 对象存储 (OSS) | ¥500 | ¥6000 |
| CDN流量 | ¥1000 | ¥12000 |
| 人力成本 (3人团队) | ¥60000 | ¥720000 |
| **总计** | **¥68500** | **¥822000** |

**盈亏平衡点**: 4125个年付费用户 (¥199 × 4125 = ¥82万)

---

## 14. 产品约束

### 14.1 平台要求

- **Web端**:
  - 兼容 Chrome 90+, Firefox 88+, Safari 14+, Edge 90+
  - 不支持IE11
- **移动端**:
  - iOS 13+ / Android 8+
  - 屏幕尺寸 > 4.7英寸
- **小程序**:
  - 微信版本 > 8.0.0
  - 支付宝版本 > 10.2.0

### 14.2 功能边界

- **不做的事情**:
  - ❌ 不做社交功能 (用户之间不互相看到)
  - ❌ 不做UGC内容 (用户不能发布公开内容)
  - ❌ 不做游戏化 (排行榜/积分系统等, P0阶段)
  - ❌ 不做成人内容 (严格审核, 违规封号)

- **做的事情**:
  - ✅ 专注1对1数字人陪伴
  - ✅ 提供情感价值 + 实用价值
  - ✅ 保护用户隐私
  - ✅ 打造高质量对话体验

### 14.3 技术约束

- **性能要求**:
  - API响应时间 P95 < 500ms
  - 3D数字人加载时间 < 5秒
  - 语音识别延迟 < 2秒
  - TTS生成延迟 < 3秒

- **并发要求**:
  - 支持1000 DAU (P0)
  - 支持10000 DAU (P1)
  - 支持100000 DAU (P3)

- **存储限制**:
  - 单文档最大10MB
  - 单用户知识库最大500MB (会员)
  - 对话历史保留1年 (可导出)

---

## 15. 成功指标

### 15.1 P0阶段 (MVP) 指标

| 指标类别 | 指标名称 | 目标值 | 数据来源 |
|---------|---------|--------|---------|
| **用户增长** | 注册用户数 | 1000+ | 数据库users表 |
| | 日活用户 (DAU) | 100+ | Redis统计 |
| | 周活用户 (WAU) | 300+ | Redis统计 |
| **用户留存** | 次日留存率 | > 40% | 埋点数据 |
| | 7日留存率 | > 20% | 埋点数据 |
| **用户参与** | 人均对话次数/天 | > 5次 | messages表 |
| | 人均对话时长/天 | > 10分钟 | 计算消息时间差 |
| | 语音使用率 | > 20% | messages表(type=voice) |
| **核心功能** | 知识库上传率 | > 30% | knowledge_base表 |
| | 数字人创建数 | 平均2个/用户 | digital_humans表 |
| **商业化** | 付费转化率 | > 5% | subscriptions表 |
| | 月度经常性收入 (MRR) | ¥5000+ | subscriptions表 |
| **用户满意度** | NPS (净推荐值) | > 30 | 问卷调查 |
| | App评分 | > 4.5 | App Store/Google Play |

### 15.2 P1阶段 指标

| 指标名称 | 目标值 |
|---------|--------|
| 总用户数 | 10000+ |
| DAU | 1000+ |
| 付费用户数 | 500+ (转化率5%) |
| MRR | ¥10000+ |
| 购物GMV/月 | ¥50万+ |
| 语音对话占比 | > 30% |

### 15.3 北极星指标

**定义**: "每周活跃对话用户数" (Weekly Active Conversation Users, WACU)

**计算方式**: 一周内至少进行5次对话的用户数

**目标**:
- P0: WACU > 200
- P1: WACU > 2000
- P2: WACU > 10000

**意义**: 衡量用户真正使用产品并获得价值, 而非仅注册不用

---

## 附录

### A. 术语表

| 术语 | 英文 | 解释 |
|------|------|------|
| 数字人 | Digital Human | AI驱动的虚拟人物, 具备对话和情感表达能力 |
| RAG | Retrieval-Augmented Generation | 检索增强生成, 通过检索知识库增强LLM回答准确性 |
| ASR | Automatic Speech Recognition | 自动语音识别, 将语音转为文字 |
| TTS | Text-to-Speech | 文字转语音 |
| LLM | Large Language Model | 大语言模型, 如GPT/通义千问/文心 |
| NPS | Net Promoter Score | 净推荐值, 衡量用户满意度 (0-10分) |
| DAU | Daily Active Users | 日活跃用户数 |
| MRR | Monthly Recurring Revenue | 月度经常性收入 |

### B. 参考资料

- 阿里云通义千问文档: https://help.aliyun.com/zh/dashscope/
- 科大讯飞开放平台: https://www.xfyun.cn/
- Google Genie 3论文: https://deepmind.google/discover/blog/genie-3/
- 中国数字人市场报告 2025: https://www.iresearch.com.cn/
- GDPR官方指南: https://gdpr.eu/

### C. 变更记录

| 版本 | 日期 | 变更内容 | 作者 |
|------|------|---------|------|
| v1.0 | 2025-01-11 | 初始版本, 完成MVP需求定义 | AI Product Team |

---

**PRD结束**

📌 **下一步行动**:
1. 产品团队评审PRD, 确认需求优先级
2. 设计师阅读PRD, 开始设计规范制定 (输入 **/设计** 召唤设计师)
3. 技术团队评估技术可行性和工期

💬 **反馈渠道**: product@mindpal.ai

---

**文档签名**:
- 产品经理: ________________  日期: 2025-01-11
- 技术负责人: ________________  日期: ________
- UI/UX设计师: ________________  日期: ________
